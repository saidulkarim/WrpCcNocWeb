@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor HttpContextAccessor

@{
    var language = int.Parse(HttpContextAccessor.HttpContext.Request.Cookies["FormLanguage"].ToString());
}

<div id="gen-info-form">
    <div class="form-group">
        <label for="ProjectName">
            @{if (language == 1)
                { <span>১. প্রকল্পের শিরোনাম</span>}
                else
                {<span>1. Project Name</span>}
            }
            <span class="text-danger bold">*</span>
        </label>
        <span class="text-danger">
            <i class="mdi mdi-help-circle-outline" tabindex="0" data-html="true" data-toggle="popover" data-trigger="focus" title="" data-placement="top"
               data-content="Please specify project name or title and can not be more than 500 characters. Press Control and b (Ctrl + b) key from keyboard to change/ toggle language."
               data-original-title="Project Name"></i>
        </span>
        <input type="text" id="ProjectName" name="ProjectName" maxlength="500" class="form-control" />
    </div>

    <!--start :: newly added on 28-Jan-2021-->
    <div class="form-group">
        <label for="RespectiveMinistry">
            @{if (language == 1)
                { <span>২. মন্ত্রণালয়</span>}
                else
                {<span>2. Respective Ministry</span>}
            }
            <span class="text-danger bold">*</span>
        </label>
        <span class="text-danger">
            <i class="mdi mdi-help-circle-outline" tabindex="0" data-html="true" data-toggle="popover" data-trigger="focus" title="" data-placement="top"
               data-content="Please select project respective ministry. This is mandatory field."
               data-original-title="Respective Ministry"></i>
        </span>

        <select id="RespectiveMinistry" name="RespectiveMinistry" class="form-control">
            @{if (language == 1)
                {
                    <option value="">বাছাই করুন...</option>
                }
                else
                {
                    <option value="">Choose...</option>
                }
            }

            @{
                List<LookUpMinistry> _mnstrys = ViewBag.LookUpMinistry;

                if (_mnstrys.Count > 0)
                {
                    foreach (LookUpMinistry mnstry in _mnstrys)
                    {
                        if (language == 1)
                        {
                            <option value="@mnstry.MinistryId">@mnstry.MinistryNameBn (@mnstry.MinistryShortNameBn)</option>
                        }
                        else
                        {
                            <option value="@mnstry.MinistryId">@mnstry.MinistryName (@mnstry.MinistryShortName)</option>
                        }
                    }
                }
            }
        </select>
    </div>

    <div class="form-group">
        <label for="RespectiveAgency">
            @{if (language == 1)
                { <span>৩. সংস্থা</span>}
                else
                {<span>3. Respective Agency</span>}
            }
            <span class="text-danger bold">*</span>
        </label>
        <span class="text-danger">
            <i class="mdi mdi-help-circle-outline" tabindex="0" data-html="true" data-toggle="popover" data-trigger="focus" title="" data-placement="top"
               data-content="Please select project respective agency. This is mandatory field."
               data-original-title="Respective Agency"></i>
        </span>

        <select id="RespectiveAgency" name="RespectiveAgency" class="form-control">
            @{if (language == 1)
                {
                    <option value="">বাছাই করুন...</option>
                }
                else
                {
                    <option value="">Choose...</option>
                }
            }

            @{
                List<LookUpAgency> _agncs = ViewBag.LookUpAgency;

                if (_agncs.Count > 0)
                {
                    foreach (LookUpAgency agnc in _agncs)
                    {
                        if (language == 1)
                        {
                            <option value="@agnc.AgencyId">@agnc.AgencyNameBn (@agnc.AgencyShortNameBn)</option>
                        }
                        else
                        {
                            <option value="@agnc.AgencyId">@agnc.AgencyName (@agnc.AgencyShortName)</option>
                        }
                    }
                }
            }
        </select>
    </div>

    <div class="form-group">
        <label for="AnyInterventionOfOtherPrj">
            @{if (language == 1)
                { <span>৪. অন্য প্রকল্পের কোন হস্তক্ষেপ আছে?</span>}
                else
                {<span>4. Is there Any Intervention of Other Projects?</span>}
            }
        </label>
        <span class="text-danger">
            <i class="mdi mdi-help-circle-outline" tabindex="0" data-html="true" data-toggle="popover" data-trigger="focus" title="" data-placement="top"
               data-content="Please select any intervention of other projects."
               data-original-title="Any Intervention of Other Projects?"></i>
        </span>
        <select id="AnyInterventionOfOtherPrj" name="AnyInterventionOfOtherPrj" class="form-control">
            @{if (language == 1)
                {
                    <option value="">বাছাই করুন...</option>
                }
                else
                {
                    <option value="">Choose...</option>
                }
            }

            @{
                List<LookUpCcModAnyInterventionPrj> _anyintprjs = ViewBag.LookUpAnyInterventionPrj;

                if (_anyintprjs.Count > 0)
                {
                    foreach (LookUpCcModAnyInterventionPrj anyint in _anyintprjs)
                    {
                        if (language == 1)
                        {
                            <option value="@anyint.AnyInterventionPrjId">@anyint.InterventionNameBn</option>
                        }
                        else
                        {
                            <option value="@anyint.AnyInterventionPrjId">@anyint.InterventionName</option>
                        }
                    }
                }
            }
        </select>
    </div>
    <!--end-->

    <div class="form-group">
        <label for="BackgroundAndRationale">
            @{if (language == 1)
                { <span>৫. প্রকল্পের পূর্ব ইতিহাস ও যৌক্তিকতা</span>}
                else
                {<span>5. Project Background and Rationale</span>}
            }
            <span class="text-danger bold">*</span>
        </label>
        <span class="text-danger">
            <i class="mdi mdi-help-circle-outline" tabindex="0" data-html="true" data-toggle="popover" data-trigger="focus" title="" data-placement="top"
               data-content="Please specify project background and rationale. Can not be more than 1000 characters. Press Control and b (Ctrl + b) key from keyboard to change/toggle language."
               data-original-title="Project Background and Rationale"></i>
        </span>
        <textarea id="BackgroundAndRationale" name="BackgroundAndRationale" maxlength="1000" class="form-control" rows="2"></textarea>
    </div>

    <div class="form-group">
        <label for="ProjectTarget">
            @{if (language == 1)
                { <span>৬. প্রকল্পের লক্ষ্য</span>}
                else
                {<span>6. Project Target</span>}
            }
            <span class="text-danger bold">*</span>
        </label>
        <span class="text-danger">
            <i class="mdi mdi-help-circle-outline" tabindex="0" data-html="true" data-toggle="popover" data-trigger="focus" title="" data-placement="top"
               data-content="Please specify project target. Can not be more than 1000 characters. Press Control and b (Ctrl + b) key from keyboard to change/toggle language."
               data-original-title="Project Target"></i>
        </span>
        <textarea id="ProjectTarget" name="ProjectTarget" maxlength="1000" class="form-control" rows="2"></textarea>
    </div>

    <div class="form-group">
        <label for="ProjectObjective">
            @{if (language == 1)
                { <span>৭. প্রকল্পের উদ্দেশ্য</span>}
                else
                {<span>7. Project Objective</span>}
            }
            <span class="text-danger bold">*</span>
        </label>
        <span class="text-danger">
            <i class="mdi mdi-help-circle-outline" tabindex="0" data-html="true" data-toggle="popover" data-trigger="focus" title="" data-placement="top"
               data-content="Please specify project objective. Can not be more than 1000 characters. Press Control and b (Ctrl + b) key from keyboard to change/toggle language."
               data-original-title="Project Objective"></i>
        </span>
        <textarea id="ProjectObjective" name="ProjectObjective" maxlength="1000" class="form-control" rows="2"></textarea>
    </div>

    <div class="form-group">
        <label for="ProjectActivity">
            @if (language == 1)
            {<span>৮. প্রকল্পের অবস্থান</span> }
            else
            { <span>8. Project Location</span>}
            <span class="text-danger bold">*</span>
        </label>
        <span class="text-danger">
            <i class="mdi mdi-help-circle-outline" tabindex="0" data-html="true" data-toggle="popover" data-trigger="focus" title="" data-placement="top"
               data-content="Please enter project location(s). You can add one or more locations."
               data-original-title="Project Location"></i>
        </span>

        <br />
        <button id="btnShowProjectLocations" type="button" data-toggle="modal" data-backdrop="static" data-keyboard="false"
                data-target="#projectLocationModal" class="btn btn-info waves-effect waves-light">
            <span class="btn-label"><i class="mdi mdi-map-plus"></i></span>
            @if (language == 1)
            {<span>প্রকল্পের অবস্থান</span> }
            else
            { <span>Project Location</span>}
            <span class="myspinner spinner-border spinner-border-sm mr-1 d-none"></span>
        </button>
        <span id="spnTotalLocations" class="badge badge-blue font-13 p-2" style="position: absolute; margin-left: 10px;"></span>

        <!-- Project Location Modal -->
        <div class="modal fade" id="projectLocationModal" tabindex="-1" role="dialog"
             aria-labelledby="projectLocationModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content p-1">
                    <div class="modal-header">
                        <h5 class="modal-title" id="projectLocationModalLabel">
                            @if (language == 1)
                            {<span>প্রকল্পের অবস্থান</span> }
                            else
                            { <span>Project Location</span>}
                        </h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        @{ await Html.RenderPartialAsync("form/_3Location"); }
                    </div>
                    <div class="modal-footer">
                        <button id="btnModalClose" type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="form-group">
        <label for="ProjectActivity">
            @{if (language == 1)
                { <span>৯. থানা বেজ ম্যাপে জিও কোডসহ প্রকল্পের সীমানা</span>}
                else
                {<span>9. Project Boundary with Geo Code at Thana Base Map</span>}
            }
        </label>
        <span class="text-danger">
            <i class="mdi mdi-help-circle-outline" tabindex="0" data-html="true" data-toggle="popover" data-trigger="focus" title="" data-placement="top"
               data-content="Please <a href='https://www.youtube.com/watch?v=2SoY_7leLpU' target='_blank' class='bold underline'>Click Here</a> to view tutorial to learn how to create a project boundary with GEO code KML file."
               data-original-title="Project Boundary Base Map"></i>
        </span>
        <br />
        <span class="btn btn-success fileinput-button waves-effect waves-light font-">
            <span class="btn-label"><i class="mdi mdi-map-marker-path"></i></span>
            <span>
                @if (language == 1)
                {<span>প্রকল্পের সীমানা</span> }
                else
                { <span>Project Boundary</span>}
            </span>
            <input type="file" name="MapFile" id="MapFile" accept="application/vnd.google-earth.kml+xml"
                   onchange="return ValidateFileUpload()" />
        </span>

        <input type="hidden" id="SelectedMapFile" name="SelectedMapFile" />
        <span id="spnKmlFileName" class="badge badge-blue font-13 p-2" style="position: absolute; margin-left: 10px;"></span>
    </div>

    <div class="form-group">
        <label for="ProjectActivity">
            @{if (language == 1)
                { <span>১০. প্রকল্পের ভৌত কাজের বিবরণ/ অবকাঠামো সমূহ</span>}
                else
                {<span>10. Project Activities/ Components</span>}
            }
        </label>
        <span class="text-danger">
            <i class="mdi mdi-help-circle-outline" tabindex="0" data-html="true" data-toggle="popover" data-trigger="focus" title="" data-placement="top"
               data-content="Please specify project activities/ components. Can not be more than 1000 characters. <br />Press Control and b (Ctrl + b) key from keyboard to change/toggle language."
               data-original-title="Project Activities/ Components Sample"></i>
        </span>
        <textarea id="ProjectActivity" name="ProjectActivity" maxlength="1000" class="form-control" rows="2"></textarea>
    </div>

    <div class="divProjectPeriod">
        <fieldset>
            <legend>
                <label for="ProjectPeriod" class="bold">
                    @{if (language == 1)
                        { <span>১১. প্রকল্প বাস্তবায়নকাল</span>}
                        else
                        {<span>11. Project Period</span>}
                    }
                    <span class="text-danger bold">*</span>
                </label>

                <span class="text-danger">
                    <i class="mdi mdi-help-circle-outline" tabindex="0" data-html="true" data-toggle="popover" data-trigger="focus" title="" data-placement="top"
                       data-content="Project <b>Starting Time</b> and <b>Completion Time</b> both are required fields."
                       data-original-title="Project Period/ প্রকল্প বাস্তবায়নকাল"></i>
                </span>
            </legend>

            <div class="row">
                <div class="form-group col-md-6">
                    <label for="ProjectStartDate">
                        @{if (language == 1)
                            { <span>শুরুর তারিখ</span>}
                            else
                            {<span>Starting Time</span>}
                        }
                    </label>

                    <span class="text-danger">
                        <i class="mdi mdi-help-circle-outline" tabindex="0" data-html="true" data-toggle="popover" data-trigger="focus" title="" data-placement="top"
                           data-content="Starting Time is required field. Date format is: dd/MM/yyyy e.g. 15/12/2020"
                           data-original-title="Starting Time/ শুরুর তারিখ"></i>
                    </span>
                    <input type="text" id="ProjectStartDate" name="ProjectStartDate" class="form-control datepicker" />
                </div>

                <div class="form-group col-md-6">
                    <label for="ProjectCompletionDate">
                        @{if (language == 1)
                            { <span>সমাপ্তির তারিখ</span>}
                            else
                            {<span>Completion Time</span>}
                        }
                    </label>

                    <span class="text-danger">
                        <i class="mdi mdi-help-circle-outline" tabindex="0" data-html="true" data-toggle="popover" data-trigger="focus" title="" data-placement="top"
                           data-content="Completion Time is required field. Date format is: dd/MM/yyyy e.g. 30/03/2020"
                           data-original-title="Completion Time/ সমাপ্তির তারিখ"></i>
                    </span>
                    <input type="text" id="ProjectCompletionDate" name="ProjectCompletionDate" class="form-control datepicker" />
                </div>
            </div>
        </fieldset>
    </div>

    <div class="form-group col-md-6" style="padding-left: 0 !important;">
        <label for="ProjectEstimatedCost">
            @{
                if (language == 1)
                { <span>১২. প্রকল্পের প্রাক্কলিত মোট ব্যয় (লক্ষ টাকায়)</span>}
                else
                {<span>12. Estimated Project Cost (In Lakh Taka)</span>}
            }
            <span class="text-danger bold">*</span>
        </label>
        <span class="text-danger">
            <i class="mdi mdi-help-circle-outline" tabindex="0" data-html="true" data-toggle="popover" data-trigger="focus" title="" data-placement="top"
               data-content="Please enter project estimated cost (in lakh taka). "
               data-original-title="Estimated Project Cost"></i>
        </span>
        <input type="number" maxlength="10" min="0" id="ProjectEstimatedCost" name="ProjectEstimatedCost" class="form-control text-right pr-1" />
    </div>

    <div class="form-group">
        <label for="ProjectOutcome">
            @{if (language == 1)
                { <span>১৩. প্রকল্পের ফলাফল</span>}
                else
                {<span>13. Project Outcome</span>}
            }
        </label>
        <span class="text-danger">
            <i class="mdi mdi-help-circle-outline" tabindex="0" data-html="true" data-toggle="popover" data-trigger="focus" title="" data-placement="top"
               data-content="Please enter project outcome. Can not be more than 1000 characters. Press Control and b (Ctrl + b) key from keyboard to change/toggle language."
               data-original-title="Project Outcome"></i>
        </span>
        <textarea id="ProjectOutcome" name="ProjectOutcome" maxlength="1000" class="form-control" rows="2"></textarea>
    </div>

    <div class="form-group">
        <label for="ProjectOutput">
            @{if (language == 1)
                { <span>১৪. প্রকল্পের আউটপুট</span>}
                else
                {<span>14. Project Output</span>}
            }
        </label>
        <span class="text-danger">
            <i class="mdi mdi-help-circle-outline" tabindex="0" data-html="true" data-toggle="popover" data-trigger="focus" title="" data-placement="top"
               data-content="Please enter project output. Can not be more than 1000 characters. Press Control and b (Ctrl + b) key from keyboard to change/toggle language."
               data-original-title="Project Output"></i>
        </span>
        <textarea id="ProjectOutput" name="ProjectOutput" maxlength="1000" class="form-control" rows="2"></textarea>
    </div>

    <div class="form-group mb-0">
        <button id="btnSaveGeneral" type="button" class="btn btn-info waves-effect waves-light">
            <span class="btn-label"><i class="mdi mdi-content-save"></i></span>
            @if (language == 1)
            {<span>সংরক্ষণ করুন</span>}
            else
            {<span>Save</span>}
            <span class="myspinner spinner-border spinner-border-sm mr-1 d-none"></span>
        </button>

        <button id="btnClearGeneral" type="button" class="btn btn-secondary waves-effect waves-light">
            <span class="btn-label"><i class="mdi mdi-close-outline"></i></span>
            @if (language == 1)
            {<span>পরিষ্কার করুন</span>}
            else
            { <span>Clear</span>}
        </button>
    </div>
</div>

<script id="GeneralInfoControls" type="text/javascript">
    jQuery(document).ready(function () {
        jQuery("#RespectiveMinistry").select2({
            placeholder: "Select an option",
            allowClear: true
        }).on('change', function () {
            var val = $("#RespectiveMinistry option:selected").val();
            var txt = $("#RespectiveMinistry option:selected").text();
        });

        jQuery("#RespectiveAgency").select2({
            placeholder: "Select an option",
            allowClear: true
        }).on('change', function () {
            var val = $("#RespectiveAgency option:selected").val();
            var txt = $("#RespectiveAgency option:selected").text();
        });

        jQuery("#AnyInterventionOfOtherPrj").select2({
            placeholder: "Select an option",
            allowClear: true
        }).on('change', function () {
            var val = $("#AnyInterventionOfOtherPrj option:selected").val();
            var txt = $("#AnyInterventionOfOtherPrj option:selected").text();
        });

        jQuery("#btnSaveGeneral").click(function () {
            var ProjectName = GetTextValue('ProjectName');

            var RespectiveAgency = GetDropdownValue('RespectiveAgency');
            var RespectiveMinistry = GetDropdownValue('RespectiveMinistry');
            var AnyInterventionOfOtherPrj = GetDropdownValue('AnyInterventionOfOtherPrj');

            var BackgroundAndRationale = GetTextValue('BackgroundAndRationale');
            var ProjectTarget = GetTextValue('ProjectTarget');
            var ProjectObjective = GetTextValue('ProjectObjective');
            var ProjectStartDate = GetTextValue('ProjectStartDate');
            var ProjectCompletionDate = GetTextValue('ProjectCompletionDate');
            var ProjectEstimatedCost = GetTextValue('ProjectEstimatedCost') == '' ? '0' : GetTextValue('ProjectEstimatedCost');
            var ProjectOutcome = GetTextValue('ProjectOutcome');
            var ProjectOutput = GetTextValue('ProjectOutput');
            var ProjectBoundaryMap = jQuery("#SelectedMapFile").val();

            if (ProjectName == '') {
                Notification('warning', 'Required Field', 'Project name can not be left empty.');
                Swal.fire('Required Field', 'Project name can not be left empty.', 'warning');
                jQuery('#ProjectName').focus();
                return;
            }

            if (RespectiveMinistry == '') {
                Notification('warning', 'Required Field', 'Respective Ministry is required field.<br />Please select a Respective Ministry.');
                Swal.fire('Required Field', 'Respective Ministry is required field.<br />Please select a Respective Ministry.', 'warning');
                jQuery('#RespectiveMinistry').focus();
                return;
            }

            if (RespectiveAgency == '') {
                Notification('warning', 'Required Field', 'Respective Agency is required field.<br />Please select a Respective Agency.');
                Swal.fire('Required Field', 'Respective Agency is required field.<br />Please select a Respective Agency.', 'warning');
                jQuery('#RespectiveAgency').focus();
                return;
            }

            if (BackgroundAndRationale == '') {
                Notification('warning', 'Required Field', 'Project background and rationale can not be left empty.');
                Swal.fire('Required Field', 'Project background and rationale can not be left empty.', 'warning');
                jQuery('#BackgroundAndRationale').focus();
                return;
            }

            if (ProjectTarget == '') {
                Notification('warning', 'Required Field', 'Project target can not be left empty.');
                Swal.fire('Required Field', 'Project target can not be left empty.', 'warning');
                jQuery('#ProjectTarget').focus();
                return;
            }

            if (ProjectObjective == '') {
                Notification('warning', 'Required Field', 'Project objective can not be left empty.');
                Swal.fire('Required Field', 'Project objective can not be left empty.', 'warning');
                jQuery('#ProjectObjective').focus();
                return;
            }

            if (ProjectStartDate == '') {
                Notification('warning', 'Required Field', 'Please select a project start date and can not be left empty.');
                Swal.fire('Required Field', 'Please select a project start date and can not be left empty.', 'warning');
                jQuery('#ProjectStartDate').focus();
                return;
            }

            if (ProjectCompletionDate == '') {
                Notification('warning', 'Required Field', 'Please select a project completion date and can not be left empty.');
                Swal.fire('Required Field', 'Please select a project completion date and can not be left empty.', 'warning');
                jQuery('#ProjectCompletionDate').focus();
                return;
            }

            if (ProjectEstimatedCost == '') {
                Notification('warning', 'Required Field', 'Please enter project estimated cost amount.');
                Swal.fire('Required Field', 'Please enter project estimated cost amount.', 'warning');
                jQuery('#ProjectEstimatedCost').focus();
                return;
            }

            if (!IsNumeric(ProjectEstimatedCost)) {
                Notification('warning', 'Required Field', 'Please enter valid project estimated cost amount.');
                Swal.fire('Required Field', 'Please enter valid project estimated cost amount.', 'warning');
                jQuery('#ProjectEstimatedCost').focus();
                return;
            }

            if (parseFloat(ProjectEstimatedCost) == 0 || parseFloat(ProjectEstimatedCost) < 0) {
                Notification('warning', 'Required Field', 'Project estimated cost amount can not be equal to zero (0) or can not be negative.');
                Swal.fire('Required Field', 'Project estimated cost amount can not be equal to zero (0) or can not be negative.', 'warning');
                jQuery('#ProjectEstimatedCost').focus();
                return;
            }

            if (ProjectBoundaryMap == '') {
                Notification('warning', 'Required Field', '6. Project Boundary with Geo Code at Thana Base Map is required!');
                Swal.fire('Required Field', '6. Project Boundary with Geo Code at Thana Base Map is required!', 'warning');
                return;
            }

            GeneralInfoSave();
        });

        jQuery("#btnClearGeneral").click(function () {
            Swal.fire({
                title: "Are you sure?",
                text: "All data will be cleared from General Information panel!",
                type: "warning",
                allowEscapeKey: false,
                allowOutsideClick: false,
                showCancelButton: !0,
                confirmButtonColor: "#3085d6",
                cancelButtonColor: "#d33",
                confirmButtonText: "Sure"
            }).then(function (t) {
                if (t.value == true) {
                    $('#gen-info-form').trigger("reset");

                    ClearTextValue('ProjectName');
                    jQuery('#RespectiveAgency').val(null).trigger('change');
                    jQuery('#RespectiveMinistry').val(null).trigger('change');
                    jQuery('#AnyInterventionOfOtherPrj').val(null).trigger('change');
                    ClearTextValue('BackgroundAndRationale');
                    ClearTextValue('ProjectTarget');
                    ClearTextValue('ProjectObjective');
                    ClearTextValue('ProjectActivity');
                    ClearTextValue('ProjectStartDate');
                    ClearTextValue('ProjectCompletionDate');
                    ClearTextValue('ProjectEstimatedCost');
                    ClearTextValue('ProjectOutcome');
                    ClearTextValue('ProjectOutput');
                    ClearTextValue('SelectedMapFile');

                    $('#spnTotalLocations, #spnKmlFileName').text('');
                    $('#tbodyProjectLocation').html('');
                }
            });
        });

        jQuery("#btnModalClose").click(function () {
            var table = $("#tbodyProjectLocation");
            var rows = table.find('tr').length;
            jQuery("#spnTotalLocations").html(rows + ' location(s) added');
        });
    });

    function GeneralInfoSave() {
        var ProjectName = GetTextValue('ProjectName');

        var RespectiveAgency = GetDropdownValue('RespectiveAgency');
        var RespectiveMinistry = GetDropdownValue('RespectiveMinistry');
        var AnyInterventionOfOtherPrj = GetDropdownValue('AnyInterventionOfOtherPrj');

        var BackgroundAndRationale = GetTextValue('BackgroundAndRationale');
        var ProjectTarget = GetTextValue('ProjectTarget');
        var ProjectObjective = GetTextValue('ProjectObjective');
        var ProjectActivity = GetTextValue('ProjectActivity');
        var ProjectStartDate = GetTextValue('ProjectStartDate');
        var ProjectCompletionDate = GetTextValue('ProjectCompletionDate');
        var ProjectEstimatedCost = GetTextValue('ProjectEstimatedCost') == '' ? '0' : GetTextValue('ProjectEstimatedCost');
        var ProjectOutcome = GetTextValue('ProjectOutcome');
        var ProjectOutput = GetTextValue('ProjectOutput');
        var ProjectBoundaryMap = jQuery("#SelectedMapFile").val();

        var pcd = {
            "ProjectId": jQuery('#ProjectId').val(),
            "UserId": 0,
            "AppSubmissionId": jQuery('#AppSubmissionId').val(),
            "ApplicationStateId": jQuery('#ApplicationStateId').val(),
            "ApprovalStatusId": jQuery('#ApprovalStatusId').val(),
            "ProjectTypeId": jQuery('#ProjectTypeId').val(),
            "ProjectName": ProjectName,

            "RespectiveAgency": RespectiveAgency,
            "RespectiveMinistry": RespectiveMinistry,
            "AnyInterventionOfOtherPrj": AnyInterventionOfOtherPrj,

            "BackgroundAndRationale": BackgroundAndRationale,
            "ProjectTarget": ProjectTarget,
            "ProjectObjective": ProjectObjective,
            "ProjectActivity": ProjectActivity,
            "ProjectStartDate": ProjectStartDate,
            "ProjectCompletionDate": ProjectCompletionDate,
            "ProjectEstimatedCost": ProjectEstimatedCost,
            "ProjectOutcome": ProjectOutcome,
            "ProjectOutput": ProjectOutput,
            "ProjectBoundaryMap": ProjectBoundaryMap
        };

        //#region project location script
        var rowCount = $('#tbodyProjectLocation tr').length;
        var LocationArray = [], ImageFiles =[];

        var table = $("#tbodyProjectLocation");
        table.find('tr').each(function (i) {
            var $tds = $(this).find('td');
            ImageFiles = [];
            ImageFiles.length = 0;

            var LocationId = $tds.eq(6).find('input[type=hidden]').val();
            LocationId = (LocationId == '') ? 0 : LocationId;
            var DistrictGeoCode = $tds.eq(0).find('input[type=hidden]').val();
            var UpazilaGeoCode = $tds.eq(1).find('input[type=hidden]').val();
            var UnionGeoCode = $tds.eq(2).find('input[type=hidden]').val();
            var Latitude = $tds.eq(3).text();
            var Longitude = $tds.eq(4).text();
            var ImageFile = $tds.eq(5).find('input[type=hidden]').val();
            //var MapFile = $tds.eq(6).find('input[type=hidden]').val();//hdSelectedMapFile

            if (LocationId == 0) {
                $tds.eq(5).find('img').each(function (i) {
                    var src = $(this).attr('src');
                    console.log(src);
                    ImageFiles.push(src);
                });
            }

            if (DistrictGeoCode != '' && DistrictGeoCode != undefined) {
                var location = {
                    'LocationId': LocationId,
                    'DistrictGeoCode': DistrictGeoCode,
                    'UpazilaGeoCode': UpazilaGeoCode,
                    'UnionGeoCode': UnionGeoCode,
                    'Latitude': Latitude,
                    'Longitude': Longitude,
                    'ImageFile': ImageFiles,
                    //'MapFile': MapFile,
                    'Error': ''
                };

                LocationArray.push(location);
            }
        });

        console.log(LocationArray);
        //#endregion

        var url = '@Url.Action("gis", "form")';
        jQuery.ajax({
            type: "POST",
            url: url,
            data: { _pcd: pcd, _locs: LocationArray },
            dataType: "json",
            success: function (data, status, jqXHR) {
                if (data.status == 'success') {
                    SetHiddenValue('ProjectId', data.id);
                    Notification('success', 'Success', data.message);
                    Swal.fire('Success', data.message, 'success');
                } else {
                    Notification('error', 'General Info Saving Error', data.message);
                    Swal.fire('General Info Saving Error', data.message, 'error');
                }
            }, error: function (jqXHR, exception) {
                var errorMsg = AjaxErrorHandle(jqXHR, exception);
                Notification('error', 'General Info Error Occured', errorMsg);
                Swal.fire('General Info Error Occured', errorMsg, 'error');
            }
        });
    }
</script>