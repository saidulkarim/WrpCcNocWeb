@model WrpCcNocWeb.Models.AdminModUsersDetail

@{
    ViewData["Title"] = "Update User Profile";
    Layout = "~/Views/Shared/_Layout.cshtml";

    AdminModUsersDetail ud = ViewBag.UpdateUserInfo as AdminModUsersDetail;
    var ac = "on";
}

<div style="padding: 5px 3px; width:100%" class="panel panel-default">
    <div class="panel-heading text-center justify-content-center">
        <h4>@ViewData["Title"]&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;@Html.ActionLink("Back to User List", "viewUsers", "account")</h4>
    </div>

    <div class="panel-body">
        <div class="account-pages mt-5 mb-5">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-md-10 col-lg-10" style="margin-top: 5px;">
                        <div class="card bg-pattern">
                            <div class="card-body">
                                <input type="hidden" id="UserId" name="UserId" value="@ud.UserId" />

                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            @Html.LabelFor(m => m.ApplicantTypeId, new { @class = "control-label" }) <span class="text-danger bold">*</span>
                                            @Html.DropDownList("ApplicantTypeId", null, string.Empty, new { @id = "ApplicantTypeId", @class = "form-control", @style = "width: 100%;" })
                                        </div>

                                        <div class="form-group">
                                            @Html.LabelFor(m => m.ApplicantName, new { @class = "control-label" }) <span class="text-danger bold">*</span>
                                            @Html.EditorFor(m => m.ApplicantName, new { htmlAttributes = new { @class = "form-control", @type = "text", @placeholder = "Enter applicant name in english", @required = "required", @autocomplete = ac } })
                                        </div>

                                        <div class="form-group" data-toggle="tooltip" title="Press Control + B to change language.">
                                            @Html.LabelFor(m => m.ApplicantNameBn, new { @class = "control-label" }) <span class="text-danger bold">*</span>
                                            @Html.EditorFor(m => m.ApplicantNameBn, new { htmlAttributes = new { @class = "form-control", @type = "text", @placeholder = "Enter applicant name in bengali", @required = "required", @autocomplete = ac } })
                                        </div>

                                        <div class="form-group">
                                            @Html.LabelFor(m => m.OrganizationName, new { @class = "control-label" }) <span class="text-danger bold">*</span>
                                            @Html.EditorFor(m => m.OrganizationName, new { htmlAttributes = new { @class = "form-control", @type = "text", @autocomplete = ac } })
                                        </div>

                                        <div class="form-group">
                                            @Html.LabelFor(m => m.OrganizationNameBn, new { @class = "control-label" }) <span class="text-danger bold">*</span>
                                            @Html.EditorFor(m => m.OrganizationNameBn, new { htmlAttributes = new { @class = "form-control datepicker", @type = "text", @autocomplete = ac } })
                                        </div>

                                        <div class="form-group">
                                            @Html.LabelFor(m => m.OrganizationAddress, new { @class = "control-label" })
                                            @Html.EditorFor(m => m.OrganizationAddress, new { htmlAttributes = new { @class = "form-control", @type = "text", @autocomplete = ac } })
                                        </div>

                                        <div class="form-group">
                                            @Html.LabelFor(m => m.OrganizationAddressBn, new { @class = "control-label" })
                                            @Html.EditorFor(m => m.OrganizationAddressBn, new { htmlAttributes = new { @class = "form-control", @type = "text", @autocomplete = ac } })
                                        </div>

                                        <div class="form-group">
                                            @Html.LabelFor(m => m.UserProfession, new { @class = "control-label" })
                                            @Html.EditorFor(m => m.UserProfession, new { htmlAttributes = new { @class = "form-control", @type = "text", @placeholder = "Profession" } })
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <div class="form-group">
                                            @Html.LabelFor(m => m.UserDesignation, new { @class = "control-label" })
                                            @Html.EditorFor(m => m.UserDesignation, new { htmlAttributes = new { @class = "form-control", @type = "text", @placeholder = "Designation" } })
                                        </div>

                                        <div class="form-group">
                                            @Html.LabelFor(m => m.UserNID, new { @class = "control-label" })
                                            @Html.EditorFor(m => m.UserNID, new { htmlAttributes = new { @class = "form-control", @type = "text" } })
                                        </div>

                                        <div class="form-group">
                                            @Html.LabelFor(m => m.UserNIDFile, new { @class = "control-label" })
                                            @Html.EditorFor(m => m.UserNIDFile, new { htmlAttributes = new { @class = "form-control", @type = "text" } })
                                        </div>

                                        <div class="form-group">
                                            @Html.LabelFor(m => m.PostalAddress, new { @class = "control-label" })
                                            @Html.EditorFor(m => m.PostalAddress, new { htmlAttributes = new { @class = "form-control", @type = "text" } })
                                        </div>

                                        <div class="form-group">
                                            @Html.LabelFor(m => m.PostalAddressBn, new { @class = "control-label" })
                                            @Html.EditorFor(m => m.PostalAddressBn, new { htmlAttributes = new { @class = "form-control", @type = "text" } })
                                        </div>

                                        <div class="form-group">
                                            @Html.LabelFor(m => m.SecurityQuestionId, new { @class = "control-label" }) <span class="text-danger bold">*</span>
                                            @Html.DropDownList("SecurityQuestionId", null, string.Empty, new { @id = "SecurityQuestionId", @class = "form-control", @style = "width: 100%;" })
                                        </div>

                                        <div class="form-group">
                                            @Html.LabelFor(m => m.SecurityQuestionAnswer, new { @class = "control-label" }) <span class="text-danger bold">*</span>
                                            @Html.EditorFor(m => m.SecurityQuestionAnswer, new { htmlAttributes = new { @class = "form-control", @type = "text", @placeholder = "Security question answer" } })
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="SignatureFileName" data-toggle="tooltip"
                                                   title="Signature must be 300 X 80 pixel (width X height) [.jpg/.png/.bmp format] and file size not more than 80 KB (Min. 3 KB)">
                                                Upload Signature <span class="text-danger bold">*</span>
                                            </label>
                                            <div class="input-group" style="width: 200px;">
                                                <div class="custom-file">
                                                    <input id="SignatureFileName" name="SignatureFileName" type="file" class="custom-file-input"
                                                           onchange="return ValidateFileUpload()" />
                                                    <label id="ViewSignatureFileName" for="SignatureFileName" class="custom-file-label">
                                                        Choose file
                                                    </label>
                                                    <img id="PrevSignatureFile" src="~/images/sample_signature.jpg" style="width: 200px; height: 36px; margin-left: 225px;" />
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <br />

                                    <div class="col-md-6" style="margin-top: 30px;">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <button id="btnSubmitProfileInfo" class="btn btn-primary btn-block" type="submit"> Submit </button>
                                                </div>
                                            </div>

                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <button id="btnClearProfileInfo" class="btn btn-secondary btn-block" type="reset"> Clear </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!--
                                @*<div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="UserFullName" class="control-label">Full Name <span class="text-danger bold">*</span></label>
                                            <input type="text" id="UserFullName" name="UserFullName" class="form-control" value="@ud.UserFullName"
                                                   placeholder="Enter full name in english" required="required" autocomplete=@ac />
                                        </div>

                                        <div class="form-group">
                                            <label for="UserFullNameBn" class="control-label">Full Name In Bengali <span class="text-danger bold">*</span></label>
                                            <input type="text" id="UserFullNameBn" name="UserFullNameBn" class="form-control" value="@ud.UserFullNameBn"
                                                   placeholder="Enter full name in bengali" required="required" autocomplete=@ac />
                                        </div>

                                        <div class="form-group">
                                            <label for="UserFatherName" class="control-label">Father Name <span class="text-danger bold">*</span></label>
                                            <input type="text" id="UserFatherName" name="UserFatherName" class="form-control" value="@ud.UserFatherName"
                                                   placeholder="Enter father name" required="required" autocomplete=@ac />
                                        </div>

                                        <div class="form-group">
                                            <label for="UserDateOfBirth" class="control-label">Date of Birth <span class="text-danger bold">*</span></label>
                                            <input type="text" id="UserDateOfBirth" name="UserFatherName" class="form-control datepicker" value="@ud.UserDateOfBirth"
                                                   placeholder="Enter date of birth" required="required" />
                                        </div>

                                        <div class="form-group">
                                            <label for="UserNID" class="control-label">NID <span class="text-danger bold">*</span></label>
                                            <input type="text" id="UserNID" name="UserNID" class="form-control" value="@ud.UserNID"
                                                   placeholder="Enter National ID" required="required" autocomplete=@ac />
                                        </div>

                                        <div class="form-group">
                                            <label for="UserPassportNo" class="control-label">Passport <span class="text-danger bold">*</span></label>
                                            <input type="text" id="UserPassportNo" name="UserPassportNo" class="form-control" value="@ud.UserPassportNo"
                                                   placeholder="Enter passport no" required="required" autocomplete=@ac />
                                        </div>

                                        <div class="form-group">
                                            <label for="UserProfession" class="control-label">Profession <span class="text-danger bold">*</span></label>
                                            <input type="text" id="UserProfession" name="UserProfession" class="form-control" value="@ud.UserProfession"
                                                   placeholder="Enter profession" required="required" autocomplete=@ac />
                                        </div>

                                        <div class="form-group">
                                            <label for="SignatureFileName">Upload Signature <span class="text-danger bold">*</span></label>
                                            <div class="input-group">
                                                <div class="custom-file">
                                                    <input id="SignatureFileName" name="SignatureFileName" type="file" class="custom-file-input" />
                                                    <label class="custom-file-label" for="SignatureFileName">
                                                        Choose file
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="UserDesignation" class="control-label">Designation <span class="text-danger bold">*</span></label>
                                            <input type="text" id="UserDesignation" name="UserDesignation" class="form-control" value="@ud.UserDesignation"
                                                   placeholder="Enter designation" required="required" autocomplete=@ac />
                                        </div>

                                        <div class="form-group">
                                            <label for="UserAddress">Address <span class="text-danger bold">*</span></label>
                                            <input id="UserAddress" name="UserAddress" class="form-control" required="required"
                                                   placeholder="Address in english" value="@ud.UserAddress" />
                                        </div>

                                        <div class="form-group">
                                            <label for="UserAddressBn">Address In Bengali <span class="text-danger bold">*</span></label>
                                            <input id="UserAddressBn" name="UserAddressBn" class="form-control" required="required"
                                                   placeholder="Address in bengali" value="@ud.UserAddressBn" />
                                        </div>

                                        <div class="form-group">
                                            <label for="UserAlternateEmail" class="control-label">Alternate Email</label>
                                            <input type="text" id="UserAlternateEmail" name="UserAlternateEmail" class="form-control" value="@ud.UserAlternateEmail"
                                                   placeholder="Enter alternate email address" required="required" autocomplete=@ac />
                                        </div>

                                        <div class="form-group">
                                            <label for="UserAlternateMobile" class="control-label">Alternate Mobile</label>
                                            <input type="text" id="UserAlternateMobile" name="UserAlternateMobile" class="form-control" value="@ud.UserAlternateMobile"
                                                   placeholder="Enter alternate mobile no" required="required" autocomplete=@ac />
                                        </div>

                                        <div class="form-group">
                                            <label for="SecurityQuestionId" class="control-label">Security Question <span class="text-danger bold">*</span></label>
                                            @Html.DropDownList("SecurityQuestionId", null, string.Empty, new { @id = "SecurityQuestionId", @class = "form-control", @style = "width: 100%;" })
                                        </div>

                                        <div class="form-group">
                                            <label for="SecurityQuestionAnswer" class="control-label">Security Question Answer <span class="text-danger bold">*</span></label>
                                            <input type="text" id="SecurityQuestionAnswer" name="SecurityQuestionAnswer" class="form-control" value="@ud.SecurityQuestionAnswer"
                                                   placeholder="Enter security question answer" required="required" autocomplete=@ac />
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6" style="margin-top: 30px;">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <button id="btnSubmitProfileInfo" class="btn btn-primary btn-block" type="submit"> Submit </button>
                                                </div>
                                            </div>

                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <button id="btnClearProfileInfo" class="btn btn-secondary btn-block" type="reset"> Clear </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>*@
                                -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script type="text/javascript">
    jQuery.noConflict();

    jQuery(document).ready(function () {
        jQuery('#UserFullNameBn, #UserAddressBn').avro({ 'bn': true });
    });

    jQuery("#btnSubmitProfileInfo").click(function () {
        var uid = GetHiddenValue('UserId');
        var input = document.getElementById('SignatureFileName');
        var files = input.files;

        Swal.fire({
            title: "Are you sure?",
            //html: 'Application will be rejected. Do you wish to continue? <br /> <div class="form-group"><label for="txtRejectReason"><span class="badge badge-info">Please Specify Reject Reason</span> <span class="text-danger bold">*</span></label><input type="text" id="txtRejectReason" name="txtRejectReason" class="form-control"></div>',
            type: "warning",
            allowEscapeKey: false,
            allowOutsideClick: false,
            showCancelButton: true,
            confirmButtonColor: "#3085d6",
            cancelButtonColor: "#d33",
            confirmButtonText: "Yes, Submit"
        }).then(function (t) {
            var uid = GetHiddenValue('UserId');
            var ApplicantTypeId = GetDropdownValue('ApplicantTypeId');
            var ApplicantName = GetTextValue('ApplicantName');
            var ApplicantNameBn = GetTextValue('ApplicantNameBn');
            var OrganizationName = GetTextValue('OrganizationName');
            var OrganizationNameBn = GetTextValue('OrganizationNameBn');
            var OrganizationAddress = GetTextValue('OrganizationAddress');
            var OrganizationAddressBn = GetTextValue('OrganizationAddressBn');
            var UserProfession = GetTextValue('UserProfession');
            var UserDesignation = GetTextValue('UserDesignation');
            var UserNID = GetTextValue('UserNID');
            var PostalAddress = GetTextValue('PostalAddress');
            var PostalAddressBn = GetTextValue('PostalAddressBn');
            var SecurityQuestionId = GetDropdownValue('SecurityQuestionId');
            var SecurityQuestionAnswer = GetTextValue('SecurityQuestionAnswer');

            var formData = new FormData();
            formData.append("UserId", uid);
            formData.append("UserRegistrationId", '0');
            formData.append("ApplicantTypeId", ApplicantTypeId);
            formData.append("ApplicantName", ApplicantName);
            formData.append("ApplicantNameBn", ApplicantNameBn);
            formData.append("OrganizationName", OrganizationName);
            formData.append("OrganizationNameBn", OrganizationNameBn);
            formData.append("OrganizationAddress", OrganizationAddress);
            formData.append("OrganizationAddressBn", OrganizationAddressBn);
            formData.append("UserProfession", UserProfession);
            formData.append("UserDesignation", UserDesignation);
            formData.append("UserNID", UserNID);
            formData.append("PostalAddress", PostalAddress);
            formData.append("PostalAddressBn", PostalAddressBn);
            formData.append("SecurityQuestionId", SecurityQuestionId);
            formData.append("SecurityQuestionAnswer", SecurityQuestionAnswer);
            formData.append("file", files[0]);

            if (t.value == true) {
                if (uid != '') {
                    var url = '@Url.Action("saveprofile", "account")';

                    $.ajax({
                        url: url,
                        data: formData,
                        processData: false,
                        contentType: false,
                        type: "POST",
                        success: function (data, status, jqXHR) {
                            console.log(data);
                            if (data.message != '') {
                                if (data.status == 'success') {
                                    Notification(data.status, data.title, data.message);
                                    Swal.fire(data.title, data.message, data.status);

                                    setTimeout(function () { RedirectToHome(); }, 5000);
                                } else {
                                    Notification(data.status, data.title, data.message);
                                    Swal.fire(data.title, data.message, data.status);
                                }
                            }
                        }, error: function (jqXHR, exception) {
                            var errorMsg = AjaxErrorHandle(jqXHR, exception);
                            Notification('error', 'Error Occured', errorMsg);
                            Swal.fire('Error Occured', errorMsg, 'error');
                        }
                    });
                } else {
                    Swal.fire('Required', 'User ID can not be leave empty!', 'warning');
                    Notification('warning', 'Required', 'User ID can not be leave empty!');
                }
            }
        });
    });

    function RedirectToHome() {
        var url = '@Url.Action("viewusers", "account")';
        window.location.href = url;
    }

    function GetTextValue(control) {
        return jQuery('#' + control).val();
    }

    function GetHiddenValue(control) {
        return jQuery('#' + control).val();
    }
    </script>
</div>